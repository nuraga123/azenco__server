<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Azenco —Å–µ—Ä–≤–∏—Å</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
      }

      .container {
        margin-top: 100px;
      }

      .server-status {
        background-color: yellow;
        width: 100px;
        height: 100px;
        border-radius: 50%;
        display: inline-block;
        margin-top: 20px;
        border: 2px solid black;
      }
      
    </style>
  </head>
  <body>
    <div class="container">
      <h1 id="service">—Å–µ—Ä–≤–∏—Å: —Ä–∞–±–æ—Ç–∞–µ—Ç üéâ</h1>
      <p>–ù–∞—á–∞–ª–æ –∑–∞–ø—É—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞: <span id="start-time"></span></p>
      <p>–ü—Ä–æ—à–ª–æ —Å–µ–∫—É–Ω–¥: <span id="elapsed-time"></span></p>
      <div class="server-status" id="server-status"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
      async function updateServerStatus(status) {
        const serverStatus = document.getElementById('server-status');
        const service = document.getElementById('service');
        if (status) {
          service.serverStatus.style.backgroundColor = 'green';
        } else {
          serverStatus.style.backgroundColor = 'red';
        }
      }

      async function getTime() {
        const serverStatus = document.getElementById('server-status');
        serverStatus.style.backgroundColor = 'yellow';
        setInterval(
          () => (serverStatus.style.backgroundColor = 'yellow'),
          1000,
        );

        const result = await axios
          .get('/users/time')
          .then((response) => {
            console.log('response');
            console.log(response.data);
            const { startTime, elapsedTime } = response.data;

            document.getElementById('start-time').innerText =
              typeof startTime !== 'undefined'
                ? startTime
                : '—Å–µ—Ä–≤–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç';
            document.getElementById('elapsed-time').innerText =
              typeof elapsedTime !== 'undefined'
                ? elapsedTime
                : '—Å–µ—Ä–≤–µ—Ä –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç';

            if (response.data) {
              updateServerStatus(response.data);
            } else {
              serverStatus.style.backgroundColor = 'red';
              console.log(
                '–°–≤–æ–π—Å—Ç–≤–æ serverStatus –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –≤ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö',
              );
              return;
            }
          })
          .catch((error) => {
            console.log('–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ —Å—Ç–∞—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–∞:', error);
          });

        return result;
      }

      setInterval(() => getTime(), 2000);
    </script>
  </body>
</html>
